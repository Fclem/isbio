{% extends "base.html" %}

{% load bootstrap_toolkit %}

{% block title %}{{ title }} :: Shiny{% endblock %}

{% block extra_head %}
	<style type="text/css">
		.span12, .span6{

		}
		iframe{
			width: 100%;
			height: 100%;
			max-height: inherit;
			max-width: inherit;
			border: 0px;
			resize: both;
		}
	</style>
{% endblock %}

{% block content %}
	<div class="row-fluid">
		&nbsp;
	</div>
	<!-- First Line -->
	<div class="row-fluid">
		<!-- 1. Left block -->
		<div class="span6">
			QC
			<div class="row-fluid">
				<div class="span6">
					<iframe id="1.1" src="" seamless="seamless"></iframe>
				</div>
				<div class="span6">
					<iframe id="1.2" src="" seamless="seamless"></iframe>
				</div>
			</div>
		</div>
		<!-- 1. Right block -->
		<div class="span6">
			Curve of dose response
			<div class="row-fluid">
				<div class="span6">
					<iframe id="1.3" src="" seamless="seamless"></iframe>
				</div>
				<div class="span6">
					<iframe id="1.4" src="" seamless="seamless"></iframe>
				</div>
			</div>
		</div>
	</div>
	<!-- Second Line -->
	<div class="row-fluid">
		<!-- 2. Left block -->
		<div class="span6">
			DSS top50
			<div class="row-fluid">
				<div class="span6">
					<iframe id="2.1" src="" seamless="seamless"></iframe>
				</div>
				<div class="span6">
					<iframe id="2.2" src="" seamless="seamless"></iframe>
				</div>
			</div>
			<div class="row-fluid">
				<div class="span6">
					<iframe id="3.1" src="" seamless="seamless"></iframe>
				</div>
				<div class="span6">
					<iframe id="3.2" src="" seamless="seamless"></iframe>
				</div>
			</div>
		</div>
		<!-- 2. Right block -->
		<div class="span6">
			Future genomics
			<div class="row-fluid">
				<div class="span6">
					<iframe id="2.3" src="" seamless="seamless"></iframe>
				</div>
				<div class="span6">
					<iframe id="2.4" src="" seamless="seamless"></iframe>
				</div>
			</div>
			<div class="row-fluid">
				<div class="span12">
					<iframe id="3.3" src="" seamless="seamless"></iframe>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		var IframeLst = [];
		//list all the iframes & store them in an array
		var inputs = document.getElementsByTagName('iframe');
		for (var index = 0; index < inputs.length; ++index) {
			IframeLst.push(inputs[index]);
		}
		//load iframe one by one not to overload the server
		function load_next(i){
			if(i<IframeLst.length) {
				//when the iframe is done loading, triggers the loading of the next one
				IframeLst[i].onload = function () {

					//wait one more second
					setTimeout(load_next(i + 1), 1000);
					console.log(IframeLst[i]);
					//IframeLst[i].replace(If)
					//load_next(i+1);
				}
				var url = document.location.origin + '/shiny/blk' + IframeLst[i].id + '/';
				IframeLst[i].src = url;
			}
		}
		//load the first iframe
		$(document).ready(function () {
			load_next(0);
			//var url = document.location.origin + '/shiny/blk' + IframeLst[0].id + '/';
			//ajax_load(url, IframeLst[0]);
		});
		function ajax_load(the_url, target) {
			$.ajax({
				type   : 'GET',
				url    : the_url,
				success: function (response, textStatus, jqXHR) {
					target.innerHTML = response;
				},
				error  : function (request, status, error) { console.log(error); },
			});
		}

	</script>
{% endblock %}